# TasteRank (맛랭크) — Product Requirements Document

> **Version**: 2.0  
> **Date**: 2025-02-09  
> **Author**: Jeff  
> **Status**: Draft  

---

## 1. 제품 개요

### 1.1 프로젝트 요약

TasteRank는 여행 중 먹은 음식을 사진과 함께 기록하고, 동행자와 공동으로 평가·랭킹하는 모바일 우선 PWA다. AI가 태그 추천, 후속 질문, 이상형 월드컵 기반 종합 랭킹을 제공한다.

**포트폴리오 겸용** — 비로그인 사용자도 공개 컬렉션과 랭킹을 자유롭게 구경할 수 있다.

### 1.2 문제 정의

- 여행 중 먹은 음식을 체계적으로 기록하고 비교하기 어렵다
- 동행자들과 "뭐가 제일 맛있었지?" 논쟁을 객관적으로 해결할 수단이 없다
- 기존 리뷰 앱은 개인 기록과 그룹 비교 기능이 부족하다

### 1.3 목표 사용자

| 유저 타입 | 설명 | 인증 필요 |
|----------|------|----------|
| **Owner** | 컬렉션 생성·관리 | ✅ Google OAuth |
| **Editor** | 초대받아 음식 추가·평가 | ✅ Google OAuth |
| **Visitor** | 공개 컬렉션 구경 (포트폴리오) | ❌ |

---

## 2. 인증 정책

### 핵심 원칙: "보는 것은 누구나, 수정은 권한자만"

**로그인 불필요 (Visitor):**
- 공개 컬렉션 목록 조회
- 컬렉션 상세 (음식 목록, 사진) 열람
- 랭킹 페이지 열람
- AI 랭킹 결과 확인

**로그인 필요 (Editor/Owner):**
- 컬렉션 생성/수정/삭제
- 음식 항목 추가/수정/삭제
- 점수 평가 및 리뷰 작성
- 이상형 월드컵 참여
- 멤버 초대 및 관리

**인증 방식:** Google OAuth only (Supabase Auth)  
**로그인 프롬프트:** 수정 액션 시도 시에만 표시 (lazy auth)

### 권한 모델

| 역할 | 컬렉션/랭킹 조회 | 음식 추가 | 점수 평가 | 멤버 초대 | 컬렉션 관리 |
|------|----------------|----------|----------|----------|-----------|
| **Visitor** | ✅ 공개만 | ❌ | ❌ | ❌ | ❌ |
| **Editor** | ✅ | ✅ | ✅ | ❌ | ❌ |
| **Owner** | ✅ | ✅ | ✅ | ✅ | ✅ |

---

## 3. 핵심 사용자 플로우

### Flow 1: Visitor — 구경하기 (비로그인)

```
[공유 링크 또는 직접 접속] → [공개 컬렉션 목록]
→ [컬렉션 선택] → [음식 목록 + 사진 구경]
→ [랭킹 탭] → [AI 랭킹 결과 확인]
```

### Flow 2: Owner — 컬렉션 생성 및 초대

```
[+ 버튼 클릭] → [Google 로그인 프롬프트]
→ [여행명, 기간, 설명 입력] → [초대 링크 생성]
→ [동행자에게 공유]
```

### Flow 3: Editor — 음식 등록 및 평가

```
[초대 링크 접속] → [Google 로그인] → [자동 합류]
→ [+ 음식 추가] → [사진 촬영/업로드]
→ [AI 태그 추천] → [음식명, 식당명, 위치, 점수, 한줄평]
→ [AI 후속 질문 응답 (선택)] → [저장]
```

### Flow 4: 이상형 월드컵 + AI 종합 랭킹

```
[🏆 월드컵 시작 (로그인 필요)]
→ [음식 사진 1:1 대결] → [전원 완료 후 AI 종합 랭킹]
→ [최종 랭킹 + AI 코멘트 (Visitor도 열람 가능)]
```

---

## 4. 기능 요구사항

### 4.1 MVP (Phase 1 — 4주)

| ID | 기능 | 우선순위 |
|----|------|----------|
| F-01 | Google OAuth (수정 시에만 로그인 요구) | P0 |
| F-02 | 프로필 (닉네임, 아바타) | P0 |
| F-03 | 컬렉션 CRUD (공개/비공개 설정) | P0 |
| F-04 | 공개 컬렉션 비로그인 열람 | P0 |
| F-05 | 초대 시스템 (코드/링크, editor 역할) | P0 |
| F-06 | 음식 등록 (사진, 음식명, 식당명, 위치, 한줄평) | P0 |
| F-07 | 점수 평가 (1~10점, 멤버별 개별) | P0 |
| F-08 | 태그 시스템 (수동 + AI 추천) | P0 |
| F-09 | 기본 랭킹 (평균 점수, 태그 필터, 공개 접근) | P0 |
| F-10 | PWA (홈 화면 추가, 기본 캐싱) | P1 |
| F-11 | 위치 기록 (Geolocation + 수동 입력) | P1 |

### 4.2 Phase 2

| ID | 기능 | 우선순위 |
|----|------|----------|
| F-12 | AI 후속 질문 (2~3개) | P1 |
| F-13 | AI 사진 분석 → 태그 자동 추출 | P1 |
| F-14 | 이상형 월드컵 (토너먼트 1:1) | P2 |
| F-15 | AI 종합 랭킹 (가중 합산) | P2 |
| F-16 | 소셜 공유 (OG 메타태그, 랭킹 카드) | P2 |
| F-17 | 지도 뷰 (방문 식당 표시) | P2 |

---

## 5. AI 기능 상세

### 5.1 태그 자동 추천
- 입력: 음식 사진 + 음식명
- 출력: 추천 태그 3~5개 (칩 UI, 유저가 선택/제거/추가)
- Claude Vision API

### 5.2 AI 후속 질문 (Phase 2)
- 음식 종류에 따라 동적 생성 또는 정의된 풀에서 선택
- 맛 특징, 재방문 의향(1~5), 가성비(1~5), 분위기 등

### 5.3 이상형 월드컵 (Phase 2)
- 항목 수에 따라 8강/16강/32강 자동 결정
- 각 멤버 개별 진행, 전원 완료 시 집계

### 5.4 AI 종합 랭킹 (Phase 2)
- 유저 평균 점수 40% + 월드컵 승률 25% + AI 질문 20% + 감성 분석 15%
- AI가 각 순위에 대한 코멘트 생성

---

## 6. 비기능 요구사항

| 항목 | 요구사항 |
|------|---------|
| 플랫폼 | PWA (Next.js 16), 모바일 우선 |
| 성능 | 이미지 업로드 < 3초, 페이지 로드 < 2초 |
| 보안 | Supabase RLS, 공개/비공개 분리 |
| 테스트 | TDD (Jest + RTL), 커버리지 80%+ |
| SEO | 공개 컬렉션 SSR, OG 메타태그 |

---

## 7. MVP 일정 (4주)

| 주차 | 목표 |
|------|------|
| **W1** | 셋업, DB 스키마, Google Auth, TDD 환경, 공개 열람 라우팅 |
| **W2** | 컬렉션 CRUD, 초대, 음식 등록 (사진/평가), RLS |
| **W3** | 랭킹 (공개 접근), AI 태그 추천, 태그 필터 |
| **W4** | PWA, 반응형 UI, SEO/OG, 테스트, 배포 |
